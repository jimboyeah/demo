<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title> Hello BizCharts for React! </title>
        <script src="../js/react.development.js"> </script>
        <script src="../js/react-dom.development.js"> </script>
        <script src="../js/babel.min.js"> </script>
        <script src="../js/BizCharts.min.js"></script>
        <script src="../js/data-set.min.js"></script>

        <!-- 
        <script src="../js/jquery.min.js"></script>
        <script src="../js/bizcharts-plugin-slider.js"></script>
        <script src="../js/numeral.min.js"></script>
        <script src="../js/polyfill.min.js"></script>
        <script src="https://unpkg.com/bizcharts-plugin-slider@2.0.0/umd/bizcharts-plugin-slider.js"></script>
        <script src="https://cdn.staticfile.org/react/16.4.0/umd/react.development.js"> </script> 
        <script src="https://cdn.staticfile.org/react-dom/16.4.0/umd/react-dom.development.js"> </script>
        <script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"> </script>
        <script src="https://unpkg.com/bizcharts@3.3.0/umd/BizCharts.min.js"></script>
        -->
        <link rel="stylesheet" href="theme.css">
        <style>#example { background:_white; }</style>
        <script>

            document.onclick = function(e){
                // document.body.className = document.body.className?"":"half" 
                render();
            }
        </script>
    </head>
    <body class="half">
        <div id="example"> </div>
        <script src="./utils.js"> </script>

    </body>
</html>

<script type="text/babel">
    // import {Component} from 'react';
    let Component = React.Component;
    
    // import { Chart, Axis, Legend, Tooltip, Geom } from 'bizcharts';
    // bizUtil.setTheme('dark');
    BizCharts.setTheme('dark');

    var 
    Axis = BizCharts.Axis,
    Chart = BizCharts.Chart,
    Coord = BizCharts.Coord,
    Facet = BizCharts.Facet,
    G2 = BizCharts.G2,
    Geom = BizCharts.Geom,
    Guide = BizCharts.Guide,
    Label = BizCharts.Label,
    Legend = BizCharts.Legend,
    Line = BizCharts.Line,
    Shape = BizCharts.Shape,
    Tooltip = BizCharts.Tooltip,
    Util = BizCharts.Util,
    View = BizCharts.View;
</script>

<script type="text/babel">
// import React from "react";
// import {G2, Chart, Geom, Axis, Tooltip, Coord, Label, Legend, View, Guide, Shape, Facet, Util } from "bizcharts";
// import DataSet from "@antv/data-set";

class Arearangeline extends React.Component {
  render() {
    var data = [
      {date: "2014-08-01", pct05: 5350, pct25: 6756, pct50: 7819, pct75: 9284, pct95: 13835 },
      {date: "2014-08-02", pct05: 4439, pct25: 5584, pct50: 6554, pct75: 8016, pct95: 12765 },
      {date: "2014-08-03", pct05: 4247, pct25: 5419, pct50: 6332, pct75: 7754, pct95: 12236 },
      {date: "2014-08-04", pct05: 3293, pct25: 4414, pct50: 5191, pct75: 6491, pct95: 10325 },
      {date: "2014-08-05", pct05: 3942, pct25: 5134, pct50: 6069, pct75: 7501, pct95: 11685 },
      {date: "2014-08-06", pct05: 2744, pct25: 5508, pct50: 6879, pct75: 9221, pct95: 17239 },
      {date: "2014-08-07", pct05: 1807, pct25: 3019, pct50: 4119, pct75: 5656, pct95: 8851 },
      {date: "2014-08-08", pct05: 1855, pct25: 3386, pct50: 4473, pct75: 5915, pct95: 10580 },
      {date: "2014-08-09", pct05: 1830, pct25: 3202, pct50: 4233, pct75: 5559, pct95: 8930 },
      {date: "2014-08-10", pct05: 1828, pct25: 3195, pct50: 4304, pct75: 5482, pct95: 9189 },
      {date: "2014-08-11", pct05: 2246, pct25: 3929, pct50: 5326, pct75: 7077, pct95: 11648 },
      {date: "2014-08-12", pct05: 2051, pct25: 3662, pct50: 4849, pct75: 6194, pct95: 10078 },
      {date: "2014-08-13", pct05: 1700, pct25: 3075, pct50: 4068, pct75: 5259, pct95: 9789 },
      {date: "2014-08-14", pct05: 2161, pct25: 3891, pct50: 5262, pct75: 6924, pct95: 11612 },
      {date: "2014-08-15", pct05: 1765, pct25: 3190, pct50: 4388, pct75: 5822, pct95: 9433 },
      {date: "2014-08-16", pct05: 2036, pct25: 3756, pct50: 4775, pct75: 6158, pct95: 9999 },
      {date: "2014-08-17", pct05: 2079, pct25: 3561, pct50: 4753, pct75: 6124, pct95: 9807 },
      {date: "2014-08-18", pct05: 2108, pct25: 3576, pct50: 4818, pct75: 6344, pct95: 10235 },
      {date: "2014-08-19", pct05: 2143, pct25: 3792, pct50: 5073, pct75: 6772, pct95: 11338 },
      {date: "2014-08-20", pct05: 2086, pct25: 3801, pct50: 5073, pct75: 6688, pct95: 12394 },
      {date: "2014-08-21", pct05: 1767, pct25: 3253, pct50: 4282, pct75: 5563, pct95: 9167 },
      {date: "2014-08-22", pct05: 1756, pct25: 3047, pct50: 3950, pct75: 5006, pct95: 7948 },
      {date: "2014-08-23", pct05: 2123, pct25: 3755, pct50: 5173, pct75: 7243, pct95: 12338 },
      {date: "2014-08-24", pct05: 1967, pct25: 3404, pct50: 4529, pct75: 5970, pct95: 9897 },
      {date: "2014-08-25", pct05: 1537, pct25: 2612, pct50: 3394, pct75: 4279, pct95: 7104 },
      {date: "2014-08-26", pct05: 2182, pct25: 3958, pct50: 5505, pct75: 7642, pct95: 12707 },
      {date: "2014-08-27", pct05: 1932, pct25: 3366, pct50: 4526, pct75: 6086, pct95: 9930 },
      {date: "2014-08-28", pct05: 1268, pct25: 2344, pct50: 3256, pct75: 4215, pct95: 6673 },
      {date: "2014-08-29", pct05: 1225, pct25: 2239, pct50: 3033, pct75: 4111, pct95: 7601 },
      {date: "2014-08-30", pct05: 1393, pct25: 2432, pct50: 3417, pct75: 4710, pct95: 8798 },
      {date: "2014-08-31", pct05: 1175, pct25: 2020, pct50: 2768, pct75: 3889, pct95: 7744 },
      {date: "2014-09-01", pct05: 989,  pct25: 1655, pct50: 2218, pct75: 3167, pct95: 6018 },
      {date: "2014-09-02", pct05: 1249, pct25: 2069, pct50: 2738, pct75: 3938, pct95: 7574 },
      {date: "2014-09-03", pct05: 936,  pct25: 1510, pct50: 1968, pct75: 2700, pct95: 5215 },
      {date: "2014-09-04", pct05: 1264, pct25: 2039, pct50: 2657, pct75: 3646, pct95: 7042 },
      {date: "2014-09-05", pct05: 1305, pct25: 2106, pct50: 2745, pct75: 3766, pct95: 7273 },
      {date: "2014-09-06", pct05: 798,  pct25: 1288, pct50: 1678, pct75: 2303, pct95: 4448 },
      {date: "2014-09-07", pct05: 1314, pct25: 2120, pct50: 2763, pct75: 3791, pct95: 7321 },
      {date: "2014-09-08", pct05: 1042, pct25: 1681, pct50: 2191, pct75: 3007, pct95: 5806 }
    ];
    var markData = [
      {date: "2014-08-06", type: "Client", version: "2.0", value: 11 },
      {date: "2014-08-20", type: "Client", version: "2.1", value: 11 },
      {date: "2014-08-27", type: "Server", version: "3.5", value: 9 },
      {date: "2014-09-03", type: "Client", version: "2.2", value: 11 }
    ]; // 格式化文本

    function formatter(text, item) {
      var point = item.point;
      var type = point["type"];
      return (
        '<div style="width: 60px;text-align: center;font-size: 12px;line-height: 1.2;color: #fff;margin-left: -8px;"><span>' +
        type +
        "</span><br><span>" +
        text +
        "</span></div>"
      );
    } // 处理数据

    var dv = new DataSet.View()
      .source(data)
      .transform({
        type: "map",
        callback: function(row) {
          row["5% - 95%"] = [row.pct05 / 1000, row.pct95 / 1000];
          row["25% - 75%"] = [row.pct25 / 1000, row.pct75 / 1000];
          row["Median"] = row.pct50 / 1000;
          return row;
        }
      })
      .transform({
        type: "fold",
        fields: ["5% - 95%", "25% - 75%"],
        key: "grade",
        value: "times"
      });

    const view1Scale = {
      date: { type: "time", ticks: ["2014-08-01", "2014-08-08", "2014-08-15", "2014-08-22", "2014-08-29", "2014-09-05"] },
      times: { min: 0, max: 18, nice: false, alias: "Time(s)", tickInterval: 2 },
      Median: { min: 0, max: 18, nice: false }
    };
    const view2Scale = {
      value: { min: 0, max: 18 },
      date: { type: "time", ticks: ["2014-08-01", "2014-08-08", "2014-08-15", "2014-08-22", "2014-08-29", "2014-09-05"] }
    };

    return (
      <div>
        <Chart height={getRootHeight()} padding={[30, 30, 80, 50]} forceFit>
          <Tooltip crosshairs />
          <Axis name="Median" visible={false} />
          <Axis
            name="date"
            title={null}
            tickLine={false}
            line={{
              stroke: "#000"
            }}
            grid={{
              line: {
                stroke: "#d9d9d9"
              }
            }}
          />

          <Axis
            name="times"
            title={{
              fill: "#000"
            }}
            line={{
              stroke: "#000"
            }}
            tickLine={false}
            grid={{
              line: {
                stroke: "#d9d9d9",
                lineDash: [0, 0]
              }
            }}
          />
          <Tooltip crosshairs />
          <View data={dv} scale={view1Scale}>
            <Axis />
            <Axis name="Median" visible={false} />
            <Geom
              type="area"
              position="date*times"
              color={["grade", ["#d8d8ff", "#6060ff"]]}
              shape="smooth"
              opacity={0.8}
            />
            <Geom
              type="line"
              position="date*Median"
              color="#000"
              shape="smooth"
              size={2}
            />
          </View>
          <View data={markData} scale={view2Scale}>
            <Tooltip visible={false} />
            <Geom
              type="interval"
              position="date*value"
              color={["type", ["#ff7f00", "#093"]]}
              size={3}
            />
            <Geom
              type="point"
              position="date*value"
              color={["type", ["#ff7f00", "#093"]]}
              shape="circle"
              size={20}
            >
              <Label
                content="version"
                custom={true}
                renderer={formatter}
                offset={-5}
              />
            </Geom>
          </View>
          <Legend name="type" visible={false} />
        </Chart>
      </div>
    );
  }
}

// ReactDOM.render(<Arearangeline />, mountNode)

</script>


<script type="text/babel">
    const root = document.getElementById('example')
    function getRootHeight(){ //window.innerHeight
        let height = window.getComputedStyle(root).height;
        console.log("getComputedStyle", height, this);
        return parseInt(height);
    }
    function render(){
        ReactDOM.render(
            <Arearangeline /> , root
        );
    }
    window.onresize = function(e){
        render();
    }
    render();
</script>