<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title> Hello BizCharts for React! </title>
        <script src="../js/react.development.js"> </script>
        <script src="../js/react-dom.development.js"> </script>
        <script src="../js/babel.min.js"> </script>
        <script src="../js/BizCharts.min.js"></script>
        <!-- <script src="https://cdn.staticfile.org/react/16.4.0/umd/react.development.js"> </script> -->
        <!-- <script src="https://cdn.staticfile.org/react-dom/16.4.0/umd/react-dom.development.js"> </script> -->
        <!-- <script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"> </script> -->
        <!-- <script src="https://unpkg.com/bizcharts@3.3.0/umd/BizCharts.min.js"></script> -->
        <link rel="stylesheet" href="theme.css">
        <script>
            document.onclick = function(e){
                // document.body.className = document.body.className?"":"half" 
                render();
            }
        </script>
    </head>
    <body class="half">
        <div id="example"> </div>
        <script src="./utils.js"> </script>

    </body>
</html>

<script type="text/babel">
    // import {Component} from 'react';
    // let Component = React.Component;
    
    // import { Chart, Axis, Legend, Tooltip, Geom } from 'bizcharts';
    // bizUtil.setTheme('dark');
    BizCharts.setTheme('dark');

    var 
    Axis = BizCharts.Axis,
    Chart = BizCharts.Chart,
    Coord = BizCharts.Coord,
    Facet = BizCharts.Facet,
    G2 = BizCharts.G2,
    Geom = BizCharts.Geom,
    Guide = BizCharts.Guide,
    Label = BizCharts.Label,
    Legend = BizCharts.Legend,
    Line = BizCharts.Line,
    Shape = BizCharts.Shape,
    Tooltip = BizCharts.Tooltip,
    Util = BizCharts.Util,
    View = BizCharts.View;
</script>

<script type="text/babel">
        class Basic extends React.Component {

            constructor(props) {
                super(props);
                this.state = {t:0}
                console.log("initalize state", this.state)
            }

            data = [
                {year: "1981", value: 15468 },
                {year: "1982", value: 26100 },
                {year: "1983", value: 15900 },
                {year: "1984", value: 37409 },
                {year: "1985", value: 47000 },
                {year: "1986", value: 21056 },
                {year: "1987", value: 31982 },
                {year: "1988", value: 32040 },
                {year: "1989", value: 33233 }
            ];

            getData() {
                let item = this.data.pop();
                let news = {year:+item.year+1, value: parseInt((Math.random()+0.5)*item.value)};
                this.data.push(item)
                this.data.push(news)
                if( this.data.length>10) this.data.shift()
                console.log("render", news)
                return this.data;
            }
            render() {
                let cols = {
                    value: {
                        min: 10000
                    },
                    year: {
                        range: [0, 1]
                    }
                };
                let data = this.getData()

                return (
                    <div>
                        <Chart onPlotClick={e=>data=this.getData()} forceRender heightFix={"100%"} data={data} scale={cols} forceFit>
                            <Axis name="year" />
                            <Axis
                                name="value"
                                label={{
                                    formatter: val => {
                                        return (val / 1000).toFixed(1) + "k";
                                    }
                                }}
                            />
                            <Tooltip
                                crosshairs={{
                                    type: "line"
                                }}
                            />
                            <Geom type="area" position="year*value" />
                            <Geom type="line" position="year*value" size={2} />
                        </Chart>
                    </div>
                );
            }
        }
</script>

<script type="text/babel">
    function render(){
        ReactDOM.render(
            <Basic /> , document.getElementById('example')
        );
    }
    render();
</script>